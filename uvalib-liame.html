<link rel="import" href="../polymer/polymer.html">

<!--
An element that is an email obfuscator.

Example:

    <uvalib-liame rid="z4chd">Doug Chestnut</uvalib-liame>

@demo demo/index.html
@hero hero.svg
-->

<dom-module id="uvalib-liame">
  <template>
    <a href="mailto:{{eid}}@virginia.edu{{rest}}"><content></content></a>
  </template>

  <script>
    Polymer({
      is: 'uvalib-liame',

      properties: {
        /**
         * `rid` is the email id (at virginia.edu) in reverse
         */
        rid: String,

        /**
         * `subject` is optional and specifies the subject line to be filled out in the email
         */
        subject: String,

        /**
         * `body` is optionl and specifies the default text to be filled out in the body of the email
         */
        body: String,
      },

      // Element Lifecycle

      ready: function() {
        this.rest = "";
        this.eid = this.rid.split("").reverse().join("");
        if (this.subject) {
          this.rest = "?subject=" + this.subject;
          if (this.body) this.rest += "&"; 
        }
        if (this.body) this.rest += "body=" + this.body; 
      },

      attached: function() {
        if (this.getContentChildNodes().length == 0) {
          var content = document.createTextNode(this.eid+"@virginia.edu");
          Polymer.dom(this).appendChild(content);
        }
      },
    });
  </script>
</dom-module>
